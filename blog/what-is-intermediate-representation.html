<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Understanding intermediate representations (IRs) in machine learning - the bridge between high-level ML frameworks and hardware-specific code generation.">
    <meta name="author" content="Ayesh Ahmad">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://a-ayesh.github.io/blog/what-is-intermediate-representation.html">
    <meta property="og:title" content="What is an Intermediate Representation in Machine Learning?">
    <meta property="og:description" content="Understanding the bridge between high-level ML frameworks and hardware-specific code generation.">
    <meta property="og:image" content="https://a-ayesh.github.io/images/profile.png">
    <meta property="article:published_time" content="2025-11-18">
    <meta property="article:author" content="Ayesh Ahmad">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:creator" content="@aayeshahmadd">
    
    <title>What is an Intermediate Representation in Machine Learning? - Ayesh Ahmad</title>
    <link rel="icon" href="../favicon.svg" type="image/svg+xml">
    <link rel="canonical" href="https://a-ayesh.github.io/blog/what-is-intermediate-representation.html">
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-content">
            <div class="profile-picture">
                <img src="../images/profile.png" alt="Profile Picture" />
            </div>
            <h2 class="sidebar-name">Ayesh Ahmad</h2>
            <p class="sidebar-bio">Building at the frontier of neuromorphic computing <br><br>Co-Founder & CTO @ <a href="https://www.cvision.dev" target="_blank" rel="noopener noreferrer">CVision</a></p>
            <ul class="contact-list">
                <li>
                    <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                        <circle cx="12" cy="10" r="3"></circle>
                    </svg>
                    <span>Islamabad, Pakistan</span>
                </li>
                <li>
                    <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9 22 9 12 15 12 15 22"></polyline>
                    </svg>
                    <span>National University of Sciences & Technology</span>
                </li>
                <li>
                    <a href="mailto:ayesh@cvision.dev" target="_blank" rel="noopener noreferrer" class="contact-link">
                        <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                            <polyline points="22,6 12,13 2,6"></polyline>
                        </svg>
                        <span>ayesh@cvision.dev</span>
                        <svg class="external-icon" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                            <polyline points="15 3 21 3 21 9"></polyline>
                            <line x1="10" y1="14" x2="21" y2="3"></line>
                        </svg>
                    </a>
                </li>
                <li>
                    <a href="#" class="contact-link calendly-link">
                        <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                        <span>Schedule a Call</span>
                    </a>
                </li>
                <li>
                    <a href="https://www.linkedin.com/in/ayesh-ahmad" target="_blank" rel="noopener noreferrer" class="contact-link">
                        <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                        </svg>
                        <span>LinkedIn</span>
                        <svg class="external-icon" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                            <polyline points="15 3 21 3 21 9"></polyline>
                            <line x1="10" y1="14" x2="21" y2="3"></line>
                        </svg>
                    </a>
                </li>
                <li>
                    <a href="https://github.com/a-ayesh" target="_blank" rel="noopener noreferrer" class="contact-link">
                        <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                        </svg>
                        <span>GitHub</span>
                        <svg class="external-icon" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                            <polyline points="15 3 21 3 21 9"></polyline>
                            <line x1="10" y1="14" x2="21" y2="3"></line>
                        </svg>
                    </a>
                </li>
                <li>
                    <a href="https://gitlab.com/a-ayesh" target="_blank" rel="noopener noreferrer" class="contact-link">
                        <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M23.955 13.587l-1.342-4.135-2.664-8.189c-.135-.423-.73-.423-.867 0L16.418 9.45H7.582L4.919 1.263c-.135-.423-.73-.423-.867 0L1.388 9.452.046 13.587c-.121.375.014.789.331 1.023L12 23.054l11.623-8.443c.318-.235.453-.647.332-1.024"/>
                        </svg>
                        <span>GitLab</span>
                        <svg class="external-icon" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                            <polyline points="15 3 21 3 21 9"></polyline>
                            <line x1="10" y1="14" x2="21" y2="3"></line>
                        </svg>
                    </a>
                </li>
                <li>
                    <a href="https://x.com/aayeshahmadd" target="_blank" rel="noopener noreferrer" class="contact-link">
                        <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                        </svg>
                        <span>X</span>
                        <svg class="external-icon" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                            <polyline points="15 3 21 3 21 9"></polyline>
                            <line x1="10" y1="14" x2="21" y2="3"></line>
                        </svg>
                    </a>
                </li>
            </ul>
        </div>
    </aside>

    <!-- Main Content Area -->
    <div class="main-container">
        <!-- Navbar -->
        <nav class="navbar">
            <div class="navbar-content">
                <button class="menu-toggle" aria-label="Toggle Menu" aria-expanded="false">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <a href="../index.html" class="navbar-home-icon" title="Portfolio">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9 22 9 12 15 12 15 22"></polyline>
                    </svg>
                </a>
                <div class="navbar-right">
                    <a href="../index.html" class="nav-link home-icon" title="Portfolio">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                            <polyline points="9 22 9 12 15 12 15 22"></polyline>
                        </svg>
                    </a>
                    <a href="../bio.html" class="nav-link">Bio</a>
                    <a href="../education.html" class="nav-link">Education</a>
                    <a href="../industry.html" class="nav-link">Industry</a>
                    <a href="../pet-projects.html" class="nav-link">Pet Projects</a>
                    <a href="../publications.html" class="nav-link">Publications</a>
                    <a href="../blogs.html" class="nav-link active">Blogs</a>
                    <a href="../files/resume.pdf" class="nav-link" target="_blank" rel="noopener noreferrer">CV</a>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="content">
            <div class="blog-post-header">
                <h1 class="main-title">What is an Intermediate Representation in Machine Learning?</h1>
                <div class="blog-post-meta">
                    <span class="blog-read-time">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polyline points="12 6 12 12 16 14"></polyline>
                        </svg>
                        6 minute read
                    </span>
                </div>
                <div class="blog-post-date">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    <strong>Published:</strong> November 18, 2025
                </div>
            </div>

            <div class="blog-post-content">
                <p>An Intermediate Representation (IR) is a data structure or code format used internally by a compiler or framework to represent a program during transformation and optimization. In the context of machine learning, IRs serve as the bridge between high-level model definitions (like those written in PyTorch or TensorFlow) and the low-level machine code that actually runs on hardware.</p>

                <p>Think of an IR as a universal translator. When you write a neural network in PyTorch, you're using Python—a high-level language that GPUs and specialized accelerators don't understand directly. The IR captures the essential structure and operations of your model in a hardware-agnostic format, allowing compilers to optimize and eventually generate code for specific targets like NVIDIA GPUs, Google TPUs, or neuromorphic chips.</p>

                <h2>Why IRs Matter for ML Deployment</h2>

                <p>The proliferation of hardware accelerators has made IRs essential. A decade ago, most ML workloads ran on CPUs or NVIDIA GPUs with CUDA. Today, the landscape includes:</p>

                <ul>
                    <li><strong>GPUs</strong> from NVIDIA, AMD, and Intel</li>
                    <li><strong>TPUs</strong> from Google, designed specifically for tensor operations</li>
                    <li><strong>NPUs</strong> (Neural Processing Units) in mobile devices from Apple, Qualcomm, and others</li>
                    <li><strong>FPGAs</strong> for customizable, low-latency inference</li>
                    <li><strong>Neuromorphic chips</strong> like Intel's Loihi or IBM's TrueNorth for brain-inspired computing</li>
                </ul>

                <p>Without a common IR, framework developers would need to write separate backends for every hardware target—an exponentially growing maintenance burden. IRs decouple the frontend (model definition) from the backend (hardware-specific code generation), enabling a many-to-many mapping through a single intermediate layer.</p>

                <h2>Popular IRs in the ML Ecosystem</h2>

                <h3>ONNX (Open Neural Network Exchange)</h3>

                <p>ONNX is perhaps the most widely adopted IR for model interchange. Developed by Microsoft and Facebook (now Meta), it defines a common set of operators and a standard file format. You can export a model from PyTorch, convert it to ONNX, and then run it using ONNX Runtime on various hardware backends. However, ONNX is primarily designed for inference—it captures the forward pass but not training-specific constructs.</p>

                <h3>TVM's Relay IR</h3>

                <p>Apache TVM is an open-source compiler stack for deep learning. Its high-level IR, called Relay, represents neural networks as functional programs with support for control flow, recursion, and automatic differentiation. Relay enables sophisticated optimizations like operator fusion, layout transformation, and quantization before lowering to TVM's low-level tensor IR for final code generation.</p>

                <h3>MLIR (Multi-Level IR)</h3>

                <p>MLIR, developed by Google and now part of the LLVM project, isn't a single IR but a framework for building IRs. It introduces the concept of "dialects"—domain-specific IR fragments that can be mixed and matched. For ML, there are dialects for TensorFlow operations, linear algebra, GPU kernels, and more. MLIR's power lies in its ability to represent computation at multiple abstraction levels within a single infrastructure, enabling progressive lowering from high-level graphs to machine code.</p>

                <h3>XLA (Accelerated Linear Algebra)</h3>

                <p>XLA is Google's domain-specific compiler for linear algebra. It's the default compiler for JAX and can be used with TensorFlow. XLA's HLO (High-Level Optimizer) IR represents computations as dataflow graphs of tensor operations, enabling whole-program optimization including fusion, memory scheduling, and target-specific code generation for TPUs and GPUs.</p>

                <h2>The Anatomy of an ML IR</h2>

                <p>Most ML IRs share common characteristics:</p>

                <ol>
                    <li><strong>Graph-based representation</strong>: Operations are nodes, and data dependencies are edges. This makes dataflow analysis and transformation straightforward.</li>
                    <li><strong>Typed tensors</strong>: Every value has a known shape and data type, enabling shape inference and memory planning.</li>
                    <li><strong>Static single assignment (SSA)</strong>: Each variable is assigned exactly once, simplifying optimization passes.</li>
                    <li><strong>Operator semantics</strong>: A defined set of primitive operations (convolution, matrix multiply, activation functions) with precise mathematical semantics.</li>
                </ol>

                <p>For example, a simple <code>y = relu(matmul(W, x) + b)</code> might be represented in an IR as:</p>

                <pre><code>%0 = matmul(%W, %x) : tensor&lt;128x64xf32&gt;
%1 = add(%0, %b) : tensor&lt;128xf32&gt;
%2 = relu(%1) : tensor&lt;128xf32&gt;
return %2</code></pre>

                <h2>IRs for Neuromorphic Computing</h2>

                <p>Standard ML IRs assume synchronous, clock-driven execution with dense tensor operations. Neuromorphic hardware operates differently—it's event-driven, asynchronous, and processes sparse spike trains rather than dense activations. This fundamental mismatch means that ONNX, Relay, and XLA aren't suitable for neuromorphic deployment without significant modification.</p>

                <p>Neuromorphic IRs must capture:</p>

                <ul>
                    <li><strong>Temporal dynamics</strong>: Spike timing, membrane potentials, and refractory periods</li>
                    <li><strong>Event-based computation</strong>: Operations triggered by spikes, not clock cycles</li>
                    <li><strong>Sparse connectivity</strong>: Neuron-to-neuron connections that don't fit neatly into tensor abstractions</li>
                    <li><strong>Hardware constraints</strong>: Neuron counts, synapse limits, and routing topology specific to each chip</li>
                </ul>

                <p>This is exactly the problem space I'm working in—building IRs that can faithfully represent spiking neural networks while enabling the compiler optimizations needed for efficient deployment on neuromorphic hardware.</p>

                <h2>Conclusion</h2>

                <p>Intermediate representations are the unsung heroes of the ML deployment stack. They enable the portability, optimization, and hardware abstraction that make modern deep learning practical. As hardware diversity continues to grow—especially with the rise of neuromorphic and other non-von Neumann architectures—the importance of well-designed IRs will only increase. Understanding IRs isn't just academic; it's essential for anyone building systems that need to run efficiently on specialized hardware.</p>
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="site-footer">
            <p>&copy; 2026 Ayesh Ahmad. All rights reserved.</p>
        </footer>
    </div>

    <script src="../script.js"></script>
</body>
</html>


